
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Escena juego &mdash; Tutorial Pong-C&amp;A 0.1 documentation</title>
    
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/translations.js"></script>
    <link rel="top" title="Tutorial Pong-C&amp;A 0.1 documentation" href="../index.html" />
    <link rel="prev" title="Escenas: menú y controles" href="EscenasMenuControles.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navegación</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="EscenasMenuControles.html" title="Escenas: menú y controles"
             accesskey="P">anterior</a></li>
        <li><a href="../index.html">Tutorial Pong-C&amp;A 0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="escena-juego">
<h1>Escena juego<a class="headerlink" href="#escena-juego" title="Enlazar permanentemente con este título">¶</a></h1>
<div class="section" id="clases-de-actores">
<h2>Clases de actores<a class="headerlink" href="#clases-de-actores" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Vamos a empezar creando los actores con sus distintas propiedades y habilidades, para eso vamos a crear un archivo aparte llamado &#8220;actores.py&#8221;. Dentro de él haremos una clase para cada actor.</p>
<p>Un ejemplo de clase para un actor sería:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Zanahoria</span><span class="p">(</span><span class="n">pilas</span><span class="o">.</span><span class="n">actores</span><span class="o">.</span><span class="n">Zanahoria</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="n">pilas</span><span class="o">.</span><span class="n">actores</span><span class="o">.</span><span class="n">Zanahoria</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">aprender</span><span class="p">(</span><span class="n">pilas</span><span class="o">.</span><span class="n">habilidades</span><span class="o">.</span><span class="n">Arrastrable</span><span class="p">)</span>

<span class="n">Zanahoria</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>Esto quedaría así:</p>
<img alt="../_images/pilas-ejemplo-actorConClase.png" class="align-center" src="../_images/pilas-ejemplo-actorConClase.png" />
<p>Conociendo como es el sistema para definir actores en clases, continuamos con el código del &#8220;Pong&#8221;.</p>
<p>Para la pelota del juego decidimos usar una bomba (&#8220;pilas.actores.Bomba()&#8221;), que explota al ganar uno de los dos jugadores:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Pelota</span><span class="p">(</span><span class="n">pilas</span><span class="o">.</span><span class="n">actores</span><span class="o">.</span><span class="n">Bomba</span><span class="p">):</span>      <span class="c"># representa la pelota del juego</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="n">pilas</span><span class="o">.</span><span class="n">actores</span><span class="o">.</span><span class="n">Bomba</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">circulo</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="n">pilas</span><span class="o">.</span><span class="n">fisica</span><span class="o">.</span><span class="n">Circulo</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">restitucion</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">friccion</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">amortiguacion</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>   <span class="c"># creamos un circulo de fisica con sus propiedades</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">imitar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">circulo</span><span class="p">)</span>      <span class="c"># hacemos que la pelota siga los movimientos del circulo de fisica</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dx</span> <span class="o">=</span> <span class="mi">1</span>      <span class="c"># creamos coeficiente de impulso para x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dy</span> <span class="o">=</span> <span class="mi">1</span>      <span class="c"># creamos coeficiente de impulso para y</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">circulo</span><span class="o">.</span><span class="n">impulsar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dx</span> <span class="o">*</span> <span class="mi">50000</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dy</span> <span class="o">*</span> <span class="mi">50000</span><span class="p">)</span>      <span class="c"># impulsamos por primera vez la pelota para que arranque el juego</span>
</pre></div>
</td></tr></table></div>
<p>Los actores que usaremos en nuestro programa serán:</p>
<ol class="arabic simple">
<li>Jugador 1</li>
<li>Jugador 2</li>
<li>Puntajes</li>
<li>Pelota</li>
</ol>
<p>Teniendo ya creada la pelota del juego, continuaremos con los jugadores. Las imágenes usadas para la creación de los mismos son:</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><img alt="../_images/pilas-BaseRoja.bmp" class="first last" src="../_images/pilas-BaseRoja.bmp" />
</td>
<td><img alt="../_images/pilas-BaseAzul.bmp" class="first last" src="../_images/pilas-BaseAzul.bmp" />
</td>
</tr>
</tbody>
</table>
<p>Comenzando con el jugador 1, haremos:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Jugador1</span><span class="p">(</span><span class="n">pilas</span><span class="o">.</span><span class="n">actores</span><span class="o">.</span><span class="n">Actor</span><span class="p">):</span>      <span class="c"># definimos la clase del jugador 1</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="n">pilas</span><span class="o">.</span><span class="n">actores</span><span class="o">.</span><span class="n">Actor</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">imagen</span> <span class="o">=</span> <span class="n">pilas</span><span class="o">.</span><span class="n">imagenes</span><span class="o">.</span><span class="n">cargar</span><span class="p">(</span><span class="s">&#39;BaseRoja.bmp&#39;</span><span class="p">)</span>      <span class="c"># le cargamos la imagen</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radio_de_colision</span> <span class="o">=</span> <span class="mi">15</span>      <span class="c"># le asignamos el radio de colision al actor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">aprender</span><span class="p">(</span><span class="n">pilas</span><span class="o">.</span><span class="n">habilidades</span><span class="o">.</span><span class="n">SeMantieneEnPantalla</span><span class="p">)</span>      <span class="c"># le enseñamos a mantenerse en pantalla con esta habilidad</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">aprender</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">MoverseConWS</span><span class="p">)</span>      <span class="c"># le enseñamos a moverse con W y S, con una habilidad creada por nosotros (explicada mas adelante) dentro de la clase Jugador1</span>
</pre></div>
</td></tr></table></div>
<p>Basicamente, lo que hicimos fue cargar una imagen (llamada &#8220;BaseRoja.bmp&#8221; en este caso), asignarle un radio de colisión, obligarlo a mantenerse en pantalla y brindarle movimiento con las teclas W y S.</p>
<p>Para el jugador 2 es basicamente lo mismo, salvo que en vez de aprender a moverse con W y S, se mueve con las teclas Arriba y Abajo.</p>
<p>A continuación les mostramos el código:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Jugador2</span><span class="p">(</span><span class="n">pilas</span><span class="o">.</span><span class="n">actores</span><span class="o">.</span><span class="n">Actor</span><span class="p">):</span>      <span class="c"># definimos la clase del jugador 2</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="n">pilas</span><span class="o">.</span><span class="n">actores</span><span class="o">.</span><span class="n">Actor</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">imagen</span> <span class="o">=</span> <span class="n">pilas</span><span class="o">.</span><span class="n">imagenes</span><span class="o">.</span><span class="n">cargar</span><span class="p">(</span><span class="s">&#39;BaseAzul.bmp&#39;</span><span class="p">)</span>      <span class="c"># le cargamos la imagen</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radio_de_colision</span> <span class="o">=</span> <span class="mi">15</span>      <span class="c"># le asignamos el radio de colision al actor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">aprender</span><span class="p">(</span><span class="n">pilas</span><span class="o">.</span><span class="n">habilidades</span><span class="o">.</span><span class="n">SeMantieneEnPantalla</span><span class="p">)</span>      <span class="c"># le enseñamos a mantenerse en pantalla con esta habilidad</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">aprender</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">MoverseConArribaAbajo</span><span class="p">)</span>      <span class="c"># le enseñamos a moverse con las teclas arriba y abajo (habilidad definida por nosotros)</span>

    <span class="k">class</span> <span class="nc">MoverseConArribaAbajo</span><span class="p">(</span><span class="n">pilas</span><span class="o">.</span><span class="n">habilidades</span><span class="o">.</span><span class="n">Habilidad</span><span class="p">):</span>      <span class="c"># esta clase define la habilidad llamada anteriormente</span>
        <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">receptor</span><span class="p">):</span>
            <span class="n">pilas</span><span class="o">.</span><span class="n">habilidades</span><span class="o">.</span><span class="n">Habilidad</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">receptor</span><span class="p">)</span>
            <span class="n">pilas</span><span class="o">.</span><span class="n">eventos</span><span class="o">.</span><span class="n">actualizar</span><span class="o">.</span><span class="n">conectar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pulsa_tecla</span><span class="p">)</span>      <span class="c"># le decimos que actualice la funcion self.pulsa_tecla</span>

        <span class="k">def</span> <span class="nf">pulsa_tecla</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evento</span><span class="p">):</span>
            <span class="n">velocidad</span> <span class="o">=</span> <span class="mi">5</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">pilas</span><span class="o">.</span><span class="n">mundo</span><span class="o">.</span><span class="n">control</span>

            <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">arriba</span><span class="p">:</span>    <span class="c"># si se ha pulsado arriba</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">receptor</span><span class="o">.</span><span class="n">y</span> <span class="o">+=</span> <span class="n">velocidad</span>     <span class="c"># movemos al receptor (actor) para arriba</span>
            <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">abajo</span><span class="p">:</span>     <span class="c"># si se ha pulsado abajo</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">receptor</span><span class="o">.</span><span class="n">y</span> <span class="o">-=</span> <span class="n">velocidad</span>     <span class="c"># movemos al receptor (actor) para abajo</span>
</pre></div>
</td></tr></table></div>
<p>Por último, necesitamos puntajes, para esto deberán definir dos clases muy simples:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Puntaje1</span><span class="p">(</span><span class="n">pilas</span><span class="o">.</span><span class="n">actores</span><span class="o">.</span><span class="n">Puntaje</span><span class="p">):</span>      <span class="c"># definimos la clase del puntaje 1</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="o">=-</span><span class="mi">70</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">220</span><span class="p">):</span>
        <span class="n">pilas</span><span class="o">.</span><span class="n">actores</span><span class="o">.</span><span class="n">Puntaje</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">pilas</span><span class="o">.</span><span class="n">colores</span><span class="o">.</span><span class="n">blanco</span>      <span class="c"># le cargamos el color</span>

<span class="k">class</span> <span class="nc">Puntaje2</span><span class="p">(</span><span class="n">pilas</span><span class="o">.</span><span class="n">actores</span><span class="o">.</span><span class="n">Puntaje</span><span class="p">):</span>      <span class="c"># definimos la clase del puntaje 2</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">70</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">220</span><span class="p">):</span>
        <span class="n">pilas</span><span class="o">.</span><span class="n">actores</span><span class="o">.</span><span class="n">Puntaje</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">pilas</span><span class="o">.</span><span class="n">colores</span><span class="o">.</span><span class="n">blanco</span>      <span class="c"># le cargamos el color</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="habilidades">
<h2>Habilidades<a class="headerlink" href="#habilidades" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="topic">
<p class="topic-title first">Habilidad:</p>
<p><strong>Una habilidad</strong> tambien <strong>es una clase</strong>, que está aplicada a un actor, y que no se ve por si sola.</p>
<p><strong>La habilidad le enseña comportamientos al actor para diferenciarse de otros de su misma especie</strong>.</p>
</div>
<p>Por ejemplo, si creamos un mono llamado mono y le enseñamos la habilidad &#8220;pilas.habilidades.Arrastrable&#8221;:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span class="n">mono</span> <span class="o">=</span> <span class="n">pilas</span><span class="o">.</span><span class="n">actores</span><span class="o">.</span><span class="n">Mono</span><span class="p">()</span>      <span class="c"># creamos al mono</span>
<span class="n">mono</span><span class="o">.</span><span class="n">aprender</span><span class="p">(</span><span class="n">pilas</span><span class="o">.</span><span class="n">habilidades</span><span class="o">.</span><span class="n">Arrastrable</span><span class="p">)</span>     <span class="c"># le enseñamos que sea arrastrable</span>
</pre></div>
</td></tr></table></div>
<p>Este mono será distinto a los demás ya que se puede arrastrar con el mouse, en este caso la habilidad que usamos ya estaba creada en pilas, pero si queremos que un actor haga cosas diferentes y no encontramos una habilidad adecuada, podemos crear nuestras propias habilidades.</p>
<p>Para crear habilidades, lo único que hay que tener en cuenta es que la clase no va a ser de tipo &#8220;pilas.actores.Actor&#8221;, ni &#8220;pilas.escenas.Escena&#8221;, sino que va a ser una habilidad de tipo &#8220;pilas.habilidades.Habilidad&#8221;.</p>
<p>Comencemos con el jugador 1 o jugador rojo, para crearlo necesitamos crear una nueva habilidad que le va a enseñar a nuestro actor a moverse con las teclas <tt class="docutils literal"><span class="pre">&lt;W&gt;</span></tt> y <tt class="docutils literal"><span class="pre">&lt;S&gt;</span></tt>, para ir arriba y abajo.</p>
<p>A continuación veremos un ejemplo sencillo de habilidad creada por nosotros y aplicable a nuestro programa, la cual <strong>debe estar definida dentro de la clase Jugador1</strong>:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">pilas.simbolos</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">class</span> <span class="nc">MoverseConWS</span><span class="p">(</span><span class="n">pilas</span><span class="o">.</span><span class="n">habilidades</span><span class="o">.</span><span class="n">Habilidad</span><span class="p">):</span>      <span class="c"># definimos la habilidad para que se mueva con W y S</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">receptor</span><span class="p">):</span>      <span class="c"># ademas de su clase necesita saber cual es su receptor (el actor)</span>
        <span class="n">pilas</span><span class="o">.</span><span class="n">habilidades</span><span class="o">.</span><span class="n">Habilidad</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">receptor</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">w</span> <span class="o">=</span> <span class="bp">False</span>      <span class="c"># esta variable sera True cuando se pulse la tecla w</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">s</span> <span class="o">=</span> <span class="bp">False</span>      <span class="c"># esta variable sera True cuando se pulse la tecla s</span>
        <span class="n">pilas</span><span class="o">.</span><span class="n">eventos</span><span class="o">.</span><span class="n">actualizar</span><span class="o">.</span><span class="n">conectar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pulsa_tecla</span><span class="p">)</span>      <span class="c"># le decimos que actualice &#39;pulsa_tecla&#39;</span>
        <span class="n">pilas</span><span class="o">.</span><span class="n">eventos</span><span class="o">.</span><span class="n">pulsa_tecla</span><span class="o">.</span><span class="n">conectar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cuando_pulsa_la_tecla</span><span class="p">)</span>
        <span class="n">pilas</span><span class="o">.</span><span class="n">eventos</span><span class="o">.</span><span class="n">suelta_tecla</span><span class="o">.</span><span class="n">conectar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cuando_suelta_la_tecla</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">pulsa_tecla</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evento</span><span class="p">):</span>      <span class="c"># esta funcion mueve el actor para arriba (si pulso w) o abajo (si pulso s)</span>
        <span class="n">velocidad</span> <span class="o">=</span> <span class="mi">5</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">w</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">receptor</span><span class="o">.</span><span class="n">y</span> <span class="o">+=</span> <span class="n">velocidad</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">s</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">receptor</span><span class="o">.</span><span class="n">y</span> <span class="o">-=</span> <span class="n">velocidad</span>

    <span class="k">def</span> <span class="nf">cuando_pulsa_la_tecla</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evento</span><span class="p">):</span>      <span class="c"># detecta si pulso una tecla y cambia el estado de las variables</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">procesar_cambio_de_estado_en_la_tecla</span><span class="p">(</span><span class="n">evento</span><span class="o">.</span><span class="n">codigo</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">cuando_suelta_la_tecla</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evento</span><span class="p">):</span>      <span class="c"># detecta si solto una tecla y cambia el estado de las variables</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">procesar_cambio_de_estado_en_la_tecla</span><span class="p">(</span><span class="n">evento</span><span class="o">.</span><span class="n">codigo</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">procesar_cambio_de_estado_en_la_tecla</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">codigo</span><span class="p">,</span> <span class="n">estado</span><span class="p">):</span>     <span class="c"># recibe y cambia el estado</span>
        <span class="n">mapa</span> <span class="o">=</span> <span class="p">{</span><span class="n">w</span><span class="p">:</span> <span class="s">&#39;w&#39;</span><span class="p">,</span> <span class="n">s</span><span class="p">:</span> <span class="s">&#39;s&#39;</span><span class="p">}</span>
        <span class="k">if</span> <span class="n">mapa</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="n">codigo</span><span class="p">):</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mapa</span><span class="p">[</span><span class="n">codigo</span><span class="p">],</span> <span class="n">estado</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>Bueno, en esta clase podemos encontrar muchas cosas nuevas y que van a parecer difíciles de entender, pero las vamos a ver de nuevo, una por una, para saber como funcionan.</p>
<p>Empecemos con la función &#8220;pilas.eventos.actualizar.conectar()&#8221;. Lo único que hace esta función es recibir otra, definida dentro de la clase (por eso lleva &#8220;self.&#8221; adelante), y ejecutarla constantemente (actualizarla).</p>
<p>Por lo general, se usa para comprobar una condición que cambia su estado (puede ser &#8220;True&#8221; o &#8220;False&#8221;, en este caso) durante el desarrollo del juego.</p>
<p>Lo que hicimos dentro de esta función que pasamos como parámetro (&#8220;self.pulsa_tecla&#8221;), fue:</p>
<ol class="arabic simple">
<li>Definir una velocidad.</li>
<li>Comprobar si se ha pulsado w, si así fue, sumar 5 (la velocidad) a la posición dentro de la coordenada &#8220;y&#8221; (hacia arriba) del actor (receptor).</li>
<li>De lo contrario, si se pulso s, en este caso, restar la velocidad a la posición &#8220;y&#8221; del actor (para que este vaya hacia abajo)</li>
</ol>
<p>Para saber si se ha pulsado o soltado una de esas teclas usamos las variables &#8220;self.w&#8221; y &#8220;self.s&#8221;, pero necesitamos que cambien su estado (valor: &#8220;True&#8221; o &#8220;False&#8221;), dependiendo de la interacción del usuario. Para esto, utilizamos la siguiente funciones: &#8220;pilas.eventos.pulsa_tecla.conectar()&#8221; y&#8221;pilas.eventos.suelta_tecla.conectar()&#8221;; que como nos dicen sus nombres, detectan la pulsación y despulsación de alguna tecla.</p>
<div class="admonition warning">
<p class="first admonition-title">Advertencia</p>
<p class="last">Hay que saber distinguir entre la función: &#8220;self.pulsa_tecla()&#8221;, <strong>definida por nosotros</strong> en la clase (por eso el &#8220;self.&#8221;); y la otra función totalmente distinta: &#8220;pilas.eventos.pulsa_tecla.conectar()&#8221;, definida en el módulo pilas y <strong>llamada por nosotros</strong>.</p>
</div>
<p>Volviendo con las funciones para detectar la pulsación de teclas, las dos tienen algo en común: llaman a otra función (creada por nosotros), &#8220;self.procesar_cambio_de_estado_en_la_tecla()&#8221;, que recibe un codigo (la tecla que se pulsó) y un estado (&#8220;True&#8221; si se pulsó, &#8220;False&#8221; si se soltó). Esta función lo que hace es:</p>
<ol class="arabic">
<li><p class="first">Crear un mapa con las posibilidades de teclas que se puedan haber pulsado (en este caso solo nesecitamos W y S).</p>
</li>
<li><p class="first">Preguntar si el codigo recibido pertenece a alguna opción del mapa (&#8220;mapa.has_key(codigo)&#8221;, ¿mapa contiene una clave &lt;W o S según sea&gt;?).</p>
</li>
<li><p class="first">Y por último usa una función de python llamada &#8220;setattr()&#8221;, que recibe tres parámetros y funciona más o menos así:</p>
<blockquote>
<div><div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="nb">setattr</span><span class="p">(</span><span class="n">parametro1</span><span class="p">,</span> <span class="n">parametro2</span><span class="p">,</span> <span class="n">parametro3</span><span class="p">)</span>
<span class="go">parametro1.parametro2 = parametro3</span>
</pre></div>
</td></tr></table></div>
<p>Lo que hace es simplemente setear atributos, como lo dice el nombre. Se le pasa un 1° parámetro que va a ser la clase, el 2° que va a ser el atributo y el 3° que va ser el valor que se le asigne.</p>
<p>Para terminar de entenderlo mejor veamos nuestro caso, haciendo de cuenta que la tecla pulsada (si es pulsada la tecla, el estado va a ser &#8220;True&#8221;) fue W:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mapa</span><span class="p">[</span><span class="n">codigo</span><span class="p">],</span> <span class="n">estado</span><span class="p">)</span>
<span class="go">self.w = True</span>
</pre></div>
</td></tr></table></div>
<p>Ahora se entiende por que declaramos las variables &#8220;self.w&#8221; y &#8220;self.s&#8221;. Para conocer el estado de cada una en la función &#8220;self.pulsa_tecla()&#8221;.</p>
</div></blockquote>
</li>
</ol>
<p>Habiendo creado ya las distintas escenas con sus respectivos fondos y actores. Nuestro juego está casi terminado, solo nos quedaría crear la parte de las colisiones (para que cuando la pelota toque un lado, se sume un punto en el puntaje; y para que a determinada cantidad de puntos explote la bomba y termine el juego).</p>
<p>En este momento nuestro &#8220;Pong&#8221; se vería así:</p>
<img alt="../_images/pilas-pong-terminado.gif" class="align-center" src="../_images/pilas-pong-terminado.gif" />
</div>
<div class="section" id="colisiones">
<h2>Colisiones<a class="headerlink" href="#colisiones" title="Enlazar permanentemente con este título">¶</a></h2>
<p>La parte de colisiones aun no está desarrollada, este tutorial será actualizado muy pronto.</p>
<div class="admonition note">
<p class="first admonition-title">Nota</p>
<p class="last">Recuerden que los puntajes deben cambiar su valor a medida que tocan los laterales; así como también, que deben crear una colisión para que la bomba rebote en las dos barras.</p>
</div>
<p><a class="reference external" href="https://github.com/LuchoCastillo/PongC-A">Acá</a> se encuentra el código del &#8220;Pong&#8221;, junto con las imágenes usadas y este tutorial.</p>
<p>Cualquier contribución será bien aceptada,
¡Suerte!</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Contenidos</a></h3>
  <ul>
<li><a class="reference internal" href="#">Escena juego</a><ul>
<li><a class="reference internal" href="#clases-de-actores">Clases de actores</a></li>
<li><a class="reference internal" href="#habilidades">Habilidades</a></li>
<li><a class="reference internal" href="#colisiones">Colisiones</a></li>
</ul>
</li>
</ul>

  <h4>Tema anterior</h4>
  <p class="topless"><a href="EscenasMenuControles.html"
                        title="Capítulo anterior">Escenas: menú y controles</a></p>
  <h3>Esta página</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/data/EscenaJuego.txt"
           rel="nofollow">Enseñar el código</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Búsqueda rápida</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Ir a" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navegación</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="EscenasMenuControles.html" title="Escenas: menú y controles"
             >anterior</a></li>
        <li><a href="../index.html">Tutorial Pong-C&amp;A 0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, Luciano Castillo.
      Creado con <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>